version: 2

project_name: chiffremento

before:
  hooks:
    - go mod tidy

release:
  header: |
    # üéâ v1.1.0 - Streaming & UX Automatis√©e

    Cette version v1.1.0 apporte une refonte majeure du moteur d'entr√©es/sorties (Streaming SIO) et simplifie consid√©rablement l'utilisation quotidienne (Extension `.chto` automatique).

    ## üöÄ Nouveaut√©s Principales

    ### ‚ö° Mode Streaming (Memoire Constante)
    *   **Fini les limites de RAM :** Chiffremento n'utilise plus `os.ReadFile`. Il utilise d√©sormais des flux (`io.Reader`/`io.Writer`) via la librairie s√©curis√©e `minio/sio`.
    *   **Performance :** Chiffrer un fichier de 10 Go ne consomme que quelques m√©ga-octets de RAM.

    ### üéÆ UX & Automatisaton
    *   **Extension `.chto` impos√©e :** Plus d'erreur possible. Les fichiers chiffr√©s ont toujours l'extension `.chto`. Le d√©chiffrement refuse tout autre fichier.
    *   **Suppression du flag `-out` :** Le nom de sortie est d√©duit automatiquement (ex: `doc.pdf` -> `doc.pdf.chto` -> `doc.pdf`).
    *   **Fail Fast :** Validation imm√©diate des arguments et extensions.

    ### üõ°Ô∏è S√©curit√© & Robustesse
    *   **Anti-DoS R√©cursif :** Protection contre les fichiers malveillants imbriquant des headers en boucle infinie.
    *   **D√©rivation HKDF (Mode Parano) :** En mode cascade, les cl√©s AES et ChaCha sont d√©sormais d√©riv√©es ind√©pendamment via HKDF.
    *   **Tripwire :** Tests unitaires qui √©chouent si le protocole binaire change silencieusement.

    ### üá´üá∑ Harmonisation
    *   **100% Fran√ßais :** Tous les logs, erreurs et commentaires techniques ont √©t√© standardis√©s en fran√ßais.

    ---

builds:
  - env:
      - CGO_ENABLED=0
    goos:
      - linux
      - windows
      - darwin
    goarch:
      - amd64
      - arm64
    ldflags:
      - -s -w -X main.version={{.Version}}

archives:
  - formats:
      - tar.gz
    name_template: >-
      {{ .ProjectName }}_
      {{- .Version }}_
      {{- .Os }}_
      {{- .Arch }}
    format_overrides:
      - goos: windows
        formats:
          - zip

checksum:
  name_template: "checksums.txt"

snapshot:
  version_template: "{{ .Tag }}-next"

changelog:
  sort: asc
  filters:
    exclude:
      - "^docs:"
      - "^test:"

brews:
  - repository:
      owner: ValMtp3
      name: homebrew-tap
      token: "{{ .Env.TAP_GITHUB_TOKEN }}"

    directory: Formula
    homepage: "https://github.com/valentinfiess/chiffremento-go-cli"
    description: "Outil de chiffrement CLI s√©curis√© et robuste en Go"
    license: "MIT"
    test: |
      system "#{bin}/chiffremento -version"
